# Render Blueprint Configuration with SQLite
# This deploys the backend to Render using SQLite (completely free)

services:
  # Backend API Service 1
  - type: web
    name: regalytics-backend
    runtime: node
    region: oregon
    plan: free
    branch: main
    rootDir: backend
    buildCommand: npm install && npm run build
    startCommand: npm start
    healthCheckPath: /api/health
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3001
      - key: JWT_SECRET
        generateValue: true
      # NO DATABASE_URL - Will use SQLite automatically
    autoDeploy: true

  # Backend API Service 2 (backup)
  - type: web
    name: regalytics-api
    runtime: node
    region: oregon
    plan: free
    branch: main
    rootDir: backend
    buildCommand: npm install && npm run build
    startCommand: npm start
    healthCheckPath: /api/health
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3001
      - key: JWT_SECRET
        generateValue: true
      # NO DATABASE_URL - Will use SQLite automatically
    autoDeploy: true

# NO DATABASE SECTION - Using SQLite instead

# Notes:
# 1. Using SQLite instead of PostgreSQL (100% free)
# 2. SQLite file is stored in /opt/render/project/src/backend/database.sqlite
# 3. No external database costs
# 4. Data persists across deployments but not across service recreations
# 5. Perfect for development/staging, can be upgraded to PostgreSQL later
